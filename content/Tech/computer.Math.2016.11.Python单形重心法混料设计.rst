Pythonå®ç°å•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡
##############################
:date: 2016-11-05 06:10
:modified: 2016-11-05 06:10
:status: published
:category: Tech
:tags: Python, å•å½¢é‡å¿ƒæ³•, æ··æ–™è®¾è®¡
:series:
:slug: implement_simplex_centroid_mix_design_by_python
:summary: ä½¿ç”¨Pythonå®ç°å•å½¢é‡å¿ƒè®¾è®¡æ³•ï¼Œè¿›è¡Œæ··æ–™è®¾è®¡
:authors: lao
:toc: show

ä»‹ç»åŠæ¦‚å¿µ
==========

å•çº¯å½¢é‡å¿ƒè®¾è®¡æ³•æ˜¯ä¸€ç§æ•ˆç‡è¾ƒé«˜çš„æ··æ–™è¯•éªŒç»Ÿè®¡æ¨¡å‹ï¼Œå¯ç”¨æ¥è®¾è®¡è¯•éªŒï¼Œå®ƒèƒ½æ ¹æ®è¯•éªŒç‚¹å’Œå“åº”å€¼ç»™å‡ºå“åº”æ›²é¢ï¼ˆæ¨¡å‹ï¼‰ã€‚
è¯¥æ³•å…·æœ‰è¾ƒé«˜çš„ç²¾åº¦å’Œå¯é æ€§ï¼Œä»¥åŠè¾ƒå°‘çš„è¯•éªŒé‡ï¼Œå¾ˆé€‚åˆæ··æ–™è¯•éªŒè®¾è®¡ã€‚

**æ¦‚å¿µ**

- å•å½¢ï¼ˆå•çº¯å½¢ï¼‰ï¼šä¸ºç©ºé—´ä¸­é¡¶ç‚¹æ¯”ç»´æ•°å¤š1çš„å‡¸å¤šè¾¹å½¢ï¼Œæ¯”å¦‚ã€‡ç»´çš„ç‚¹ã€ä¸€ç»´çš„çº¿æ®µï¼ŒäºŒç»´çš„ä¸‰è§’å½¢ã€ä¸‰ç»´çš„å››é¢ä½“ç­‰ã€‚
- å“åº”å€¼ï¼šæŸä¸€è¯•éªŒç‚¹è¯•éªŒåçš„è¯„ä»·ã€‚
- ä¸‰è§’åæ ‡ç³»ï¼šç”±ä¸‰è§’å½¢æ„æˆçš„åæ ‡ç³»ï¼Œé¡¶ç‚¹ä»£è¡¨å¯¹åº”æˆåˆ†çš„æœ€å¤§å€¼ã€‚ç‰¹ç‚¹æ˜¯ä¸‰è§’å½¢å†…ï¼ˆå«è¾¹ï¼‰ä¸€ç‚¹ :math:`P(ax,by,cz)`ï¼Œè¿‡Pä½œä¸‰æ¡å¯¹ä¸‰è§’å½¢è¾¹çš„å¹³è¡Œçº¿ï¼Œå¯ä»¥ç¡®å®šx,y,zçš„æ¯”ä¾‹ã€‚å¦‚å›¾æ‰€ç¤ºã€‚

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.introduce_simplex_design.png
    :alt: å•å½¢é‡å¿ƒæ³•ç¤ºæ„å›¾

- ç­‰å€¼çº¿ï¼šå°†æŸä¸€æŒ‡æ ‡ä¸­æ•°å€¼ç›¸åŒçš„ç‚¹è¿çº¿ã€‚ç­‰å€¼çº¿å®é™…ä¸Šæ˜¯å°†ç©ºé—´ï¼ˆZè½´ï¼‰æŠ•å½±åˆ°å¹³é¢ï¼ˆXYè½´ï¼‰çš„è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾ã€‚

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.contour_lines.png
    :alt: ç­‰å€¼çº¿ç¤ºæ„å›¾

å•å½¢æ ¼å­è®¾è®¡
============

è®¾è¯•éªŒä¸­è€ƒå¯Ÿçš„æŒ‡æ ‡ä¸º :math:`y` ï¼Œé‚£ä¹ˆ :math:`y` ä¸ :math:`p` ä¸ªå› å­ :math:`x_1,x_2,...,x_p` çš„å…³ç³»å¯ä»¥è¡¨ç¤ºä¸ºï¼š:math:`y=f(x_1,x_2,\dot,x_p )+\varepsilon`

å…¶ä¸­ï¼Œ :math:`\varepsilon` æ˜¯éšæœºè¯¯å·®ï¼Œä¸”è¦ä¿è¯ :math:`0\leq x\leq 1 ,\sum_{i=1}^p x_i=1`

ç§° :math:`y=f(x_1,x_2,\dots,x_p)` ä¸ºå“åº”å‡½æ•°ï¼Œå½“å“åº”å‡½æ•°ä¸­çš„æœªçŸ¥å‚æ•°ç”¨ä¼°è®¡å€¼ä»£æ›¿åä¾¿å¾—åˆ°å›å½’æ–¹ç¨‹ï¼Œä¹Ÿç§°å“åº”æ›²é¢æ–¹ç¨‹ã€‚

ç”±äº :math:`f(x_1,x_2,...,x_p)` å½¢å¼å¾€å¾€æ˜¯æœªçŸ¥çš„ï¼Œé€šå¸¸ç”¨ :math:`x_1,x_2,\dots,x_p` çš„ä¸€ä¸ª :math:`d` æ¬¡å¤šé¡¹å¼è¡¨ç¤ºï¼Œæ­¤æ—¶ä¸€ä¸ªæ··æ–™è¯•éªŒç”±å› å­æ•° :math:`p` ä¸å“åº”å¤šé¡¹å¼çš„æ¬¡æ•° :math:`d` æ¥ç¡®å®šï¼Œä»¥åç”¨ :math:`M\{p,d\}` è¡¨ç¤ºä¸€ä¸ªæ··æ–™è¯•éªŒã€‚
å³ ï¼šï¼ˆå…¬å¼1ï¼‰

.. math::

  y&=f(x_1,x_2,\dots,x_p) \\
   &=\sum_{i=1}^p\eta_ix_i+\sum_{i\leq j}\eta_{ij}x_ix_j+\sum_{i\leq j\leq k}\eta_{ijk}x_ix_jx_k+\cdots

å•å½¢æ ¼å­è®¾è®¡æ˜¯ ``ScheffÃ©`` æå‡ºçš„ä¸€ç§æ··æ–™è®¾è®¡ã€‚ :math:`M\{p,d\}` çš„å•å½¢æ ¼å­è®¾è®¡ï¼Œä¸º :math:`d` é˜¶æ ¼å­è®¾è®¡ï¼Œå®ƒå°†å•å½¢çš„è¾¹åˆ’åˆ†æˆ :math:`d` ç­‰ä»½ï¼Œåœ¨ç­‰åˆ†ç‚¹åšä¸å…¶å®ƒè¾¹å¹³è¡Œçš„ç›´çº¿ï¼Œå½¢æˆè®¸å¤šæ ¼å­ï¼Œæ•…åå•å½¢æ ¼å­è®¾è®¡ã€‚

:math:`p=1` ï¼Œä¸ºç‚¹ï¼› :math:`p=2` ï¼Œä¸ºçº¿æ®µï¼› :math:`p=3` ï¼Œä¸ºä¸‰è§’å½¢ï¼›  :math:`p=4` ï¼Œä¸ºå››é¢ä½“ï¼› :math:`p=5` ï¼Œä¸ºè¶…å››é¢ä½“â€¦â€¦

ä¸¾ä¾‹ï¼š :math:`p=3` ï¼Œä¸€é˜¶ã€äºŒé˜¶å’Œä¸‰é˜¶å•å½¢æ ¼å­è®¾è®¡çš„ç‚¹åˆ†å¸ƒå›¾ã€‚

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.grid.png
    :alt: æ ¼å­è®¾è®¡ç¤ºæ„å›¾

å•å½¢é‡å¿ƒè®¾è®¡
============

å•å½¢æ ¼å­è®¾è®¡çš„ç¼ºé™·æ˜¯åœ¨ :math:`M\{p,d\}` å•å½¢æ ¼å­è®¾è®¡ä¸­ï¼Œå½“ :math:`d>2` æ—¶æŸäº›æ··æ–™è®¾è®¡ä¸­æ ¼å­ç‚¹çš„éé›¶åæ ‡ï¼ˆå¦‚ :math:`M\{3,3\}` ä¸­çš„8ã€9åŠå…¶å¯¹ç§°ç‚¹ï¼‰å¹¶ä¸ç›¸ç­‰ï¼Œè¿™ç§éå¯¹ç§°æ€§ä¼šä½¿æŸäº›ç‚¹å¯¹å›å½’ç³»æ•°çš„ä¼°è®¡äº§ç”Ÿè¾ƒå¤§çš„å½±å“ï¼Œä¸ºæ”¹è¿›è¿™ä¸€ç‚¹ï¼Œ ``ScheffÃ©`` æå‡ºäº†ä¸€ç§åªè€ƒè™‘æœ‰ç›¸ç­‰éé›¶åæ ‡çš„å•å½¢é‡å¿ƒè®¾è®¡ï¼Œæ—¢æ¶ˆé™¤äº†ä»¥ä¸Šç¼ºé™·ï¼Œåˆä¸è‡³äºè¯•éªŒç‚¹æ•°å¤ªå¤šã€‚

å•å½¢é‡å¿ƒè®¾è®¡ [#]_ çš„è¯•éªŒç‚¹ä¸º :math:`1` åˆ° :math:`p` ä¸ªé¡¶ç‚¹çš„é‡å¿ƒï¼Œé¡¶ç‚¹æœ¬èº«å°±æ˜¯é‡å¿ƒï¼Œä¸¤ä¸ªé¡¶ç‚¹çš„é‡å¿ƒæ˜¯å®ƒä»¬è¿çº¿çš„ä¸­ç‚¹ï¼Œä¸‰ä¸ªé¡¶ç‚¹çš„é‡å¿ƒæ˜¯å®ƒä»¬ç»„æˆæ­£ä¸‰è§’å½¢çš„ä¸­å¿ƒï¼Œâ€¦â€¦ï¼Œ :math:`p` ä¸ªé¡¶ç‚¹çš„é‡å¿ƒå°±æ˜¯è¯¥å•å½¢çš„ä¸­å¿ƒã€‚

æ­¤æ—¶ç»™å‡ºçš„å¤šé¡¹å¼æ¨¡å‹ç§°ä¸º ``ScheffÃ©å•å½¢é‡å¿ƒè®¾è®¡çš„å¤šé¡¹å¼æ¨¡å‹`` ã€‚å…·ä½“å¦‚ä¸‹ï¼Œæ³¨æ„æœ€åä¸€é¡¹ã€‚ï¼ˆå…¬å¼2ï¼‰

.. math::

  y&=f(x_1,x_2,\cdots,x_p) \\
   &=\sum_{i=1}^p\eta_ix_i+\sum_{i\leq j}\eta_{ij}x_ix_j+\sum_{i\leq j\leq k}\eta_{ijk}x_ix_jx_k+\cdots+\eta_{12\cdots p}x_1x_2\cdots x_p

å…¶ä¸­ï¼Œè‹¥ :math:`p=3` ï¼Œç”±äºåªå–é‡å¿ƒè¯•éªŒï¼Œæ•…æœ‰ï¼š

.. math::

  y&=f(x_1,x_2,x_3) \\
   &=\sum_{i=1}^3\eta_ix_i+\sum_{i\leq j}\eta_{ij}x_ix_j+\eta_{123}x_1x_2x_3

åˆ†åˆ«å– :math:`x_i=1, x_j=x_k=0;x_i=x_ğ‘—=1/2,x_k=0;x_i=x_ğ‘—=x_k=1/3` ,åˆ†åˆ«ä»£å…¥å•å½¢é‡å¿ƒè®¾è®¡çš„å¤šé¡¹å¼ï¼Œå¯å¾—å„ç³»æ•°ä¸å„å“åº”å€¼çš„å…³ç³»ã€‚

å„ç³»æ•°ä¸å„å“åº”å€¼çš„å…³ç³»å¦‚ä¸‹ï¼š

.. math::

  \begin{cases}
  \eta_i&=y_i \\
  \eta_{ij}&=2\big(2^1y_{ij}-1^1(y_i+y_j)\big) \\
  \eta_{ijk}&=3\big(3^2y_{ijk}-2^2(y_{ij}+y_{ik}+y_{jk})+1^2(y_i+y_j+y_k)\big)
  \end{cases}

å…¶å®ç»è¿‡æ¨å¯¼ï¼Œå¯ä»¥è·å¾—ä¸€èˆ¬å…¬å¼çš„ï¼Œè‹¥ :math:`S_r=\{i_1,i_2,\cdots,i_r\}` ä¸ºå…³äº :math:`(1,2,\cdots,p)` çš„æŸä¸ª :math:`r` å…ƒç´ çš„å­é›†ï¼Œåˆ™:ï¼ˆå…¬å¼3)

.. math::

  \eta_{S_r}=r\Big(\sum_{t=1}^r(-1)^{r-t}t^{r-1}L_t(S_r)\Big)

å…¶ä¸­ ï¼Œä» :math:`S_r` å¯¹åº”çš„ :math:`r` ä¸ªåˆ†é‡ä¸­å– :math:`t` ä¸ªï¼Œ :math:`L_t(S_r)` è¡¨ç¤ºæ‰€æœ‰ :math:`C_r^t` ä¸ªåˆ†é‡ç­‰æ¯”ä¾‹æ··æ–™å“åº”çš„å’Œï¼ˆç®€å•çš„è¯´å°±æ˜¯ :math:`1` åˆ° :math:`r` å– :math:`t` ä¸ªçš„ä¸é‡å¤ç»„åˆï¼‰ã€‚

ä¸‹é¢ä¸¾ä¾‹è®¡ç®— :math:`\eta_{1234}` ï¼š

åœ¨ :math:`\eta_{1234}` ä¸­ï¼Œ

.. math::

  \begin{cases}
  r& = 4 \\
  S_4& = \{i_1,i_2,\cdots,i_r\}=\{1,2,3,4\} \\
  L_1(S_4)& = y_1+y_2+y_3+y_4 \\
  L_2(S_4)& = y_{12}+y_{13}+y_{14}+y_{23}+y_{24}+y_{34} \\
  L_3(S_4)& = y_{123}+y_{124}+y_{134}+y_{234} \\
  L_4(S_4)& = y_{1234}
  \end{cases}

æ‰€ä»¥æ ¹æ®å…¬å¼3æœ‰ï¼š

.. math::
  \begin{split}
  \eta_{1234} & = r\Big(\sum_{t=1}^r(-1)^{r-t}t^{r-1}L_t(S_r)\Big) \\
  & = 4\Big(\sum_{t=1}^4(-1)^{4-t}t^{4-1}L_t(S_4)\Big) \\
  & = 4\Big((-1)^{4-1}1^{4-1}L_1(S_4)+(-1)^{4-2}2^{4-1}L_2(S_4)+(-1)^{4-3}3^{4-1}L_3(S_4)+(-1)^{4-4}4^{4-1}L_4(S_4)\Big) \\
  & =-4(y_1+y_2+y_3+y_4)+32(y_{12}+y_{13}+y_{14}+y_{23}+y_{24}+y_{34})-108(y_{123}+y_{124}+y_{134}+y_{234})+256y_{1234}
  \end{split}


å†ä¸¾ä¾‹è®¡ç®— :math:`\eta_{23}` ï¼š

åœ¨ :math:`\eta_{23}` ä¸­ï¼Œ

.. math::

  \begin{cases}
  r& = 2 \\
  S_2& = \{i_1,i_2,\cdots,i_r\}=\{2,3\} \\
  L_1(S_2)& = y_2+y_3\\
  L_2(S_2)& = y_{23} \\
  \end{cases}

æ‰€ä»¥æ ¹æ®å…¬å¼3æœ‰ï¼š

.. math::

  \begin{split}
  \eta_{23} & = r\Big(\sum_{t=1}^r(-1)^{r-t}t^{r-1}L_t(S_r)\Big) \\
  & = 2\Big(\sum_{t=1}^2(-1)^{2-t}t^{2-1}L_t(S_2)\Big) \\
  & = 2\Big((-1)^{2-1}1^{2-1}L_1(S_2)+(-1)^{2-2}2^{2-1}L_2(S_2)\Big) \\
  & =2\Big(-(y_2+y_3)+2y_{23}\Big)
  \end{split}

å•å½¢é‡å¿ƒæ³•ä»£ç å®ç°
==================

#. å…ˆå¯¼å…¥ç›¸åº”çš„åŒ…ã€‚

   .. code-block:: python

     import numpy as np
     from itertools import chain, combinations

#. ç”±å…¬å¼3å¯çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆ :math:`S_r` ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å«ç©ºé›†çš„å¹‚é›†ï¼Œç®€å•åœ°ï¼Œç”Ÿæˆä¸€ä¸ªä¸å«ç©ºé›†çš„ `Power Set`_ ï¼Œè¿™é‡Œæ¼”ç¤º ``n_point`` ä¸ºå¯¹åº”çš„  :math:`p` ã€‚

   .. code-block:: python

     n_point = ...
     nums = range(n_point)
     # generate a powerset except zeroset
     test_points = tuple(chain.from_iterable(
         map(lambda num: combinations(nums, num + 1), nums)))

#. æœ‰äº† :math:`S_r` ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€ä¸ªç”Ÿæˆ :math:`L_t(S_r)` ï¼ŒåŠ :math:`\eta_{S_r}` ï¼Œç„¶åä¼ å…¥å„ç‚¹å®æµ‹çš„ :math:`y` ï¼Œå³å¯è®¡ç®—å‡ºå“åº”æ›²é¢çš„ç³»æ•°ï¼š `_response_surface_coef` ã€‚

   .. code-block:: python

     y = np.array([...])
     _response_surface_coef = []
     for i, test_point in enumerate(test_points):
         r = len(test_point)
         temp = 0
         for j in range(1, r + 1):
             for test_point_pos in combinations(test_point, j):
                 t = len(test_point_pos)
                 temp += y[test_points.index(test_point_pos)] * \
                     r * (-1)**(r - t) * t**(r - 1)
         _response_surface_coef.append(temp)

#. æœ‰äº†å“åº”æ›²é¢çš„ç³»æ•°ï¼Œå³å¯ç®—å‡ºæ¯ä¸ª :math:`\begin{pmatrix}x_1,\dots,x_n\end{pmatrix}` çš„å“åº”å€¼ã€‚ **æ­¤å¤„è¾“å…¥çš„æ˜¯x'ï¼Œä¹Ÿå°±æ˜¯ç¼–ç çŸ©é˜µã€‚**

   .. code-block:: python

     prediction = _response_surface_coef.dot(
       [X.take(test_point_pos, axis=1).prod(axis=1)
       for test_point_pos in test_points]
     )

å¸¦ä¸‹ç•Œçš„è®¾è®¡
=============

ç”±äºå•å½¢é‡å¿ƒè¦æ±‚ :math:`0\leq x_i\leq 1` ï¼Œä½†åœ¨å®é™…è¯•éªŒä¸­ï¼Œå¾ˆéš¾åšåˆ°ã€‚å¦‚æ··å‡åœŸæºåˆæ–™è®¾è®¡è¯•éªŒä¸­ï¼Œå–ç…¤ç°æˆ–çŸ³ç²‰ç­‰ä¸º100%æ—¶æ— æ³•è·å–æœ‰æ•ˆæ•°æ®ã€‚

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.lower_bound1.png
    :alt: å¸¦ä¸‹ç•Œçš„å•å½¢é‡å¿ƒæ³•ç¤ºæ„å›¾1

å¦‚ä¸Šå›¾ï¼Œ :math:`a_i` ä¸ºå„æˆåˆ†æœ€å°å«é‡ï¼Œæˆ‘ä»¬å°† :math:`\{x'_i\}` ç§°ä¸ºè‡ªç„¶ç©ºé—´ï¼Œ :math:`\{x_i\}` ç§°ä¸ºç¼–ç ç©ºé—´ï¼ˆå®é™…å€¼ï¼‰ï¼Œè¦åœ¨ç¼–ç ç©ºé—´ä¸Šè¿›è¡Œå•å½¢é‡å¿ƒè®¾è®¡ï¼Œå¿…é¡»å°†å…¶æ˜ å°„åˆ°è‡ªç„¶ç©ºé—´ä¸Šï¼ˆç¼–ç å€¼ï¼‰ã€‚

.. math::

  \begin{cases}
  0\leq x'_i\leq 1 \\
  \sum_{i=1}^pa_i\leq 1 \\
  0\leq x'_i\leq x_i\leq 1
  \end{cases}

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.lower_bound2.png
    :alt: å¸¦ä¸‹ç•Œçš„å•å½¢é‡å¿ƒæ³•ç¤ºæ„å›¾2

ç¼–ç å€¼ä¸å®é™…å€¼å¯ä»¥è¿›è¡Œçº¿æ€§å˜æ¢ :math:`\{x'_i\}\leftrightarrow\{x_i\}` ï¼Œç”±ä¸Šå›¾å¯å¾—å˜æ¢çŸ©é˜µ :math:`M` ï¼š

.. math::

  M =
  \begin{bmatrix}
  1+a_1-\sum_{i=1}^pa_i & a_1 & a_1 & \dots & a_1 \\
  a_2 & 1+a_2-\sum_{i=1}^pa_i & a_1 & \dots & a_1 \\
  \vdots & \vdots & \ddots & \dots &\vdots \\
  a_p & a_p & a_p & \dots & 1+a_p-\sum_{i=1}^pa_i \\
  \end{bmatrix}

å†é€šè¿‡åæ ‡ä¸è‡ªç„¶ç©ºé—´ç›¸ä¹˜å¾— :math:`x_i` ï¼ˆå…¬å¼4)

.. math::

  \begin{pmatrix}
  x_1 \\ x_2 \\ \vdots \\ x_p
  \end{pmatrix} =
  M\begin{pmatrix}
  x'_1 \\ x'_2 \\ \vdots \\ x'_p
  \end{pmatrix}

å®é™…å€¼ä¸ç¼–ç å€¼ä¹Ÿå¯ä»¥æŒ‰ä»¥ä¸‹å…¬å¼è¿›è¡Œè½¬æ¢ï¼ˆçº¿æ€§å˜æ¢åŒ–ç®€çš„å…¬å¼ï¼Œè™½ç„¶æ–‡çŒ®ä¸­ç”¨çš„å¤šï¼Œä½†ä¸ªäººè§‰å¾—ä¸å¤Ÿç›´è§‚ï¼Œä¸æ¨èä½¿ç”¨ï¼‰ï¼š

.. math::

  \begin{cases}
  x'_i&=(1-\sum_{i=1}^pa_i)x_i+a_i \\
  x_i&=\frac{x'_i-a_i}{1-\sum_{i=1}^pa_i}
  \end{cases}

ç¼–ç ç©ºé—´ä¸Šçš„ç‚¹ :math:`X` ä¸ºé…æ–™çš„çœŸå®æ¯”ä¾‹ï¼Œè€Œè‡ªç„¶ç©ºé—´çš„ç‚¹ :math:`X'` ï¼ˆç¼–ç å€¼ï¼‰åˆ™ä¸ºå˜æ¢åçš„ç¬¦åˆå•çº¯å½¢è®¾è®¡çš„æ¯”ä¾‹ã€‚

ç¼–ç ç©ºé—´æ˜ å°„åˆ°çš„è‡ªç„¶ç©ºé—´å¹¶ä¸æ˜¯æˆåˆ†å‡ä¸º100%çš„å•çº¯å½¢ï¼Œä»…ä»…æ˜¯æ¦‚å¿µä¸Šçš„è‡ªç„¶ç©ºé—´ã€‚æ•…åº”ç›´æ¥æŒ‰å•çº¯å½¢é‡ç‚¹è®¾è®¡ï¼Œå¾—åˆ°æ•°æ®ä¹‹åé€šè¿‡ç­‰å€¼çº¿æ‰¾åˆ°è‡ªç„¶ç©ºé—´ä¸­çš„ç‚¹ï¼Œå†é€šè¿‡ç¼–ç è½¬æ¢å¾—åˆ°çœŸå®çš„é…æ¯”ã€‚

å¸¦ä¸‹ç•Œçš„å•å½¢é‡å¿ƒæ³•ä»£ç å®ç°
==========================

å‡è®¾ä¸‹ç•Œä¸ºå˜é‡ ``lower_bounds`` ï¼Œ :math:`lower\_bounds = [a_1,a_2,\dots,a_p]` ï¼Œå½“ :math:`lower\_bounds = [0,\dots,0]` æ—¶ï¼Œå³æ˜¯æ™®é€šçš„å•å½¢é‡å¿ƒæ³•ã€‚

#. ç”±å…¬å¼3ç”Ÿæˆ :math:`S_r`

   .. code-block:: python

     n_point = ...
     nums = range(n_point)
     # generate a powerset except zeroset
     test_points = tuple(chain.from_iterable(
         map(lambda num: combinations(nums, num + 1), nums)))

#. ç”Ÿæˆå˜æ¢çŸ©é˜µ :math:`M` ï¼Œ

   .. code-block:: python

     _M = lower_bounds.repeat(n_point).reshape(
         (n_point, n_point)) \
         - np.eye(n_point) \
         - (1 - lower_bounds.sum())

#. å¦‚å‰æ‰€è¿°ï¼Œæœ‰äº† :math:`S_r` ï¼Œç„¶åä¼ å…¥å„ç‚¹å®æµ‹çš„ :math:`y` ï¼Œå³å¯è®¡ç®—å‡ºå“åº”æ›²é¢çš„ç³»æ•°ï¼š ``_response_surface_coef`` ï¼Œæ³¨æ„ï¼Œæ­¤å¤„ä¸éœ€è¦è½¬æ¢çŸ©é˜µ ``M`` ã€‚

   .. code-block:: python

     y = np.array([...])
     _response_surface_coef = []
     for i, test_point in enumerate(test_points):
         r = len(test_point)
         temp = 0
         for j in range(1, r + 1):
             for test_point_pos in combinations(test_point, j):
                 t = len(test_point_pos)
                 temp += y[test_points.index(test_point_pos)] * \
                     r * (-1)**(r - t) * t**(r - 1)
         _response_surface_coef.append(temp)

#. æœ‰äº†å“åº”æ›²é¢çš„ç³»æ•°ï¼Œå³å¯é€šè¿‡è½¬æ¢çŸ©é˜µ ``_M`` å’ŒçœŸå®æ¯”ä¾‹ ``X`` ç®—å‡ºæ¯ä¸ª :math:`\begin{pmatrix}x'_1,\dots,x'_n\end{pmatrix}` çš„å“åº”å€¼ã€‚ **æ­¤å¤„è¾“å…¥çš„æ˜¯Xï¼Œä¹Ÿå°±æ˜¯ç¼–ç çŸ©é˜µã€‚**

   .. code-block:: python

     XX = X.dot(np.linalg.inv(_M.T))
     prediction = _response_surface_coef.dot(
       [XX.take(test_point_pos, axis=1).prod(axis=1)
       for test_point_pos in test_points]
     )

åº”ç”¨ä¸¾ä¾‹è¯´æ˜
============

è¿™é‡Œå¯¹ä¸€ç§è°ƒæ–™å’Œä¸€ç§æ··å‡åœŸçš„å¸¦ä¸‹ç•Œçº¦æŸå•å½¢é‡å¿ƒè¯•éªŒè®¾è®¡è¿›è¡Œäº†åº”ç”¨çš„ä¸¾ä¾‹ã€‚

ä¸¤ä¸ªä¾‹å­å‡ä¸º3æˆåˆ†æ··æ–™è¯•éªŒï¼Œç”±äºå…¬å¼2ã€å…¬å¼3ã€å…¬å¼4å‡æ˜¯ä¸€èˆ¬æƒ…å½¢çš„å…¬å¼ï¼Œå¯ä»¥æ¨å¹¿åˆ°ä»»æ„æ•°é‡æˆåˆ†çš„æ··æ–™è¯•éªŒï¼Œä¸èµ˜è¿°ã€‚

ä¾‹1ï¼Œè°ƒæ–™é…åˆ¶
--------------

ä¸€ç§è°ƒæ–™ç”±ä¸‰ç§æˆåˆ† :math:`Aã€Bã€C` æ··åˆåˆ¶æˆ :math:`Aã€Bã€C` å„ä¸ºå‘³ç²¾ã€ç›ã€äº”é¦™ç²‰ã€‚ :math:`a\geq 0.2,b\geq 0.4,c\geq0.2` ã€‚æ±‚è®¾è®¡æ–¹æ¡ˆã€‚

æ­¤å¤„å¯ä»¥æŒ‰å…¬å¼1é‡‡ç”¨ :math:`M\{3,2\}` å•å½¢æ ¼å­è®¾è®¡ï¼Œæœ¬æ–‡ä¸»è¦è®²å•å½¢é‡å¿ƒè®¾è®¡ï¼Œå°±ä¸æŒ‰æ ¼å­è®¾è®¡æ¥äº†ã€‚é‡‡ç”¨å•å½¢é‡å¿ƒè®¾è®¡ï¼Œå–ç‚¹å¦‚ä¸‹å›¾ï¼š

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.ex1design.png
    :alt: ç¤ºä¾‹1è®¾è®¡å›¾

æ ¹æ® :math:`a\geq 0.2,b\geq 0.4,c\geq0.2` ç”»å‡ºå°å•å½¢ï¼Œå³é»‘è‰²å°ä¸‰è§’ï¼Œç„¶åæ ¹æ®å•å½¢é‡å¿ƒè®¾è®¡æ ‡å‡º7ä¸ªé‡å¿ƒï¼ˆçº¢è‰²æ•°å­—è¡¨ç¤ºï¼‰

ç”±å…¬å¼4åˆ—å‡ºç¼–ç çŸ©é˜µï¼š

.. math::

  M &=
  \begin{bmatrix}
  1+a-(a+b+c) & a & a \\
  b & 1+b-(a+b+c) & b \\
  c & c & 1+c-(a+b+c) \\
  \end{bmatrix} \\
  &=
  \begin{bmatrix}
  0.4 & 0.2 & 0.2 \\
  0.4 & 0.6 & 0.4 \\
  0.2 & 0.2 & 0.4 \\
  \end{bmatrix}

æ ¹æ®å…¬å¼2ã€å…¬å¼3å’Œ :math:`X'*(Z.T)` å¯è½»æ¾åˆ—å‡ºè¯•éªŒè¡¨å’Œè¯•éªŒç»“æœä»¥åŠå£æ„Ÿå¾—åˆ†ï¼ˆA*ã€B*ã€C*ä¸ºç¼–ç å€¼ï¼Œ`å‘³ç²¾_` ã€`ç›_` ã€`äº”é¦™ç²‰_` åˆ™ä¸ºå®é™…æˆåˆ†ï¼‰

+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
| è¯•éªŒå·          | `A*`         | `B*`         | `C*`         | `å‘³ç²¾_`     | `ç›_`       | `äº”é¦™ç²‰_`   | å£æ„Ÿ |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
|                 | :math:`x'_1` | :math:`x'_2` | :math:`x'_3` | :math:`x_1` | :math:`x_2` | :math:`x_3` |      |
+=================+==============+==============+==============+=============+=============+=============+======+
| :math:`y_1`     | 1            | 0            | 0            | 0.4         | 0.4         | 0.2         | 5    |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
| :math:`y_2`     | 0            | 1            | 0            | 0.2         | 0.6         | 0.2         | 11   |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
| :math:`y_3`     | 0            | 0            | 1            | 0.2         | 0.4         | 0.4         | 8    |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
| :math:`y_{12}`  | 1/2          | 1/2          | 0            | 0.3         | 0.5         | 0.2         | 10   |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
| :math:`y_{13}`  | 1/2          | 0            | 1/2          | 0.3         | 0.4         | 0.3         | 2    |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
| :math:`y_{23}`  | 0            | 1/2          | 1/2          | 0.2         | 0.5         | 0.3         | 10   |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+
| :math:`y_{123}` | 1/3          | 1/3          | 1/3          | 4/15        | 7/15        | 4/15        | 13   |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+


å°†ç»“æœå’Œç¼–ç å€¼ä»£å…¥å…¬å¼2å¾—ï¼š

.. math::

  y=159x'_1x'_2x'_3+8x'_1x'_2-18x'_1x'_3+5x'_1+2x'_2x'_3+11x'_2+8x'_3

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.ex1result.png
    :alt: ç¤ºä¾‹1ç»“æœå›¾

ä½œä¸‰è§’åæ ‡å›¾ï¼Œæ ¹æ®ä¸‰è§’åæ ‡ç³»åœ¨æœ€å¤§å€¼ä½œå›¾ï¼Œå¯å¾—è‡ªç„¶ç©ºé—´ä¸­
æœ€å¤§å€¼åæ ‡ :math:`{x'_i}` ä¸ºï¼š

.. math::

  \begin{pmatrix}
  x'_1 \\ x'_2 \\ x'_3\end{pmatrix}=\begin{pmatrix}0.26 \\ 0.48 \\ 0.26
  \end{pmatrix}

ç”¨ç¼–ç çŸ©é˜µè½¬æ¢å¾—çœŸå®æ¯”ä¾‹ä¸ºï¼š

.. math::

  \begin{pmatrix}0.252,0.496,0.252\end{pmatrix}

å³ï¼ŒæŒ‰è¿™ä¸ªæ¯”ä¾‹é…åˆ¶çš„è°ƒæ–™å‘³é“æœ€å¥½ã€‚


ä¾‹2ï¼Œæ··å‡åœŸå¼ºåº¦é¢„æµ‹
-------------------

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.ex2design.png
    :alt: ç¤ºä¾‹2è®¾è®¡å›¾

å¦‚ä¸Šå›¾ï¼Œæ··å‡åœŸç”¨èƒ¶å‡ææ–™ä¸ºæ°´æ³¥ï¼ŒçŸ¿ç²‰ï¼Œç…¤ç°ï¼Œå…¶ä¸­æ°´æ³¥ç”¨é‡åœ¨25%ä»¥ä¸Šï¼Œæ±‚å•å½¢é‡å¿ƒè¯•éªŒæ–¹æ¡ˆã€‚

è¿™æ˜¯ä¸€ä¸ªçº¦æŸè®¾è®¡é—®é¢˜ï¼Œæ°´æ³¥ç”¨é‡25%ä»¥ä¸Šï¼Œå³ :math:`a_1\geq 0.25, a_2=a_3=0` ã€‚
ç¼–ç çŸ©é˜µ :math:`M` ä¸ºï¼š

.. math::

  \begin{bmatrix}
  1 & 0.25 & 0.25 \\
  0 & 0.75 & 0 \\
  0 & 0 & 0.75
  \end{bmatrix}


æ ‡ä¸Š7ä¸ªå®éªŒç‚¹ï¼Œåˆ—å‡ºè¯•éªŒè¡¨å¹¶æ ¹æ®è¡¨æ¥åšå®éªŒå¾—åˆ°ç»“æœ [#]_ ï¼š

+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
| è¯•éªŒå·          | A*           | B*           | C*           | `æ°´æ³¥_`     | `çŸ¿ç²‰_`     | `ç…¤ç°_`     |      | å¼ºåº¦(MPa) |      |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
|                 | :math:`x'_1` | :math:`x'_2` | :math:`x'_3` | :math:`x_1` | :math:`x_2` | :math:`x_3` | 3d   | 28d       | 180d |
+=================+==============+==============+==============+=============+=============+=============+======+===========+======+
| :math:`y_1`     | 1            | 0            | 0            | 1           | 0           | 0           | 63.1 | 88.3      | 96   |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
| :math:`y_2`     | 0            | 1            | 0            | 0.25        | 0.75        | 0           | 29.0 | 56.2      | 77   |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
| :math:`y_3`     | 0            | 0            | 1            | 0.25        | 0           | 0.75        | 22.2 | 53.5      | 75.4 |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
| :math:`y_{12}`  | 1/2          | 1/2          | 0            | 0.625       | 0.375       | 0           | 50.6 | 84.5      | 90.1 |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
| :math:`y_{13}`  | 1/2          | 0            | 1/2          | 0.625       | 0           | 0.375       | 44.5 | 92.3      | 102  |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
| :math:`y_{23}`  | 0            | 1/2          | 1/2          | 0.25        | 0.375       | 0.375       | 26.5 | 62.8      | 86   |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+
| :math:`y_{123}` | 1/3          | 1/3          | 1/3          | 0.5         | 0.25        | 0.25        | 40.3 | 80.5      | 96.5 |
+-----------------+--------------+--------------+--------------+-------------+-------------+-------------+------+-----------+------+

å°†ç»“æœå’Œç¼–ç å€¼ä»£å…¥å…¬å¼2å¾—ï¼š

.. math::

  y_{3d}&=63.1x'_1+29.0x'_2+22.2x'_3+18.2x'_1 x'_2+7.4x'_1 x'_3+3.6x'_2 x'_3âˆ’28.2x'_1 x'_2 x'_3 \\
  y_{28d}&=88.3x'_1+56.2x'_2+53.5x'_3+49x'_1 x'_2+85.6x'_1 x'_3+31.8x'_2 x'_3âˆ’107.7x'_1 x'_2 x'_3 \\
  y_{180d}&=96x'_1+77x'_2+75.4x'_3+14.9x'_1 x'_2+65.2x'_1 x'_3+39.2x'_2 x'_3+13.5x'_1 x'_2 x'_3

å¯¹ä¸Šé¢ä¸‰å¼ä½œä¸‰è§’åæ ‡å›¾ï¼Œå¯ä»¥æ¸…æ™°åœ°çœ‹å‡ºå„ç»„åˆ†å¯¹å¼ºåº¦çš„è´¡çŒ®ã€‚ä»å›¾ä¸­æ±‚å‡º :math:`x'_1` , :math:`x'_2` , :math:`x'_3` åæ ‡ï¼Œå†åˆ©ç”¨ç¼–ç çŸ©é˜µå³å¯æ¢ç®—å‡ºå®é™…å„ç»„åˆ†æ¯”ä¾‹ã€‚å¦å¤–ï¼Œä»3dä¸28dã€180då¯¹æ¯”ï¼Œè¯´æ˜å‰æœŸæ˜¯æ°´æ³¥ã€çŸ¿ç²‰å¯¹å¼ºåº¦è´¡çŒ®å¤§ï¼ŒåæœŸç…¤ç°è´¡çŒ®é€æ¸è¶…è¿‡çŸ¿ç²‰ã€‚

**ä½œå›¾**

å¯¹ç»„åˆ†çš„å•å½¢é‡å¿ƒè®¾è®¡å¯ä»¥ä½œå›¾ã€‚

.. image:: {static}/static/images/article/computer.Math.2016.11.Pythonå•å½¢é‡å¿ƒæ³•æ··æ–™è®¾è®¡.static.ex2result.png
    :alt: ç¤ºä¾‹2ç»“æœå›¾

.. _`Power Set`: https://en.wikipedia.org/wiki/Power_set

.. [#] å…³é¢–ç”·. æ··æ–™è¯•éªŒè®¾è®¡. ä¸Šæµ·ç§‘å­¦æŠ€æœ¯å‡ºç‰ˆç¤¾, 1990.

.. [#] å­™ä¼Ÿ, ä¸¥æä¸œ. å¤åˆèƒ¶å‡ææ–™ç»„æˆä¸æ··å‡åœŸæŠ—å‹å¼ºåº¦å®šé‡å…³ç³»ç ”ç©¶[J]. æ±å—å¤§å­¸å­¸å ± (è‡ªç„¶ç§‘å­¸ç‰ˆ), 2003, 33(4): 450-453.
